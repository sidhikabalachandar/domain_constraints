# domain_constraints
Code to generate synthetic data experiments and associated results in "Domain constraints improve healthcare risk prediction when outcome data is missing" by Sidhika Balachandar, Nikhil Garg, and Emma Pierson.

## Regenerating results
1. <strong>Conda environment.</strong> The conda environment we use is specified in <TT>domain_constraints.yml</TT>.
2. <strong>Generating synthetic data.</strong> We provide code to generate data using three different data generating processes: 1) Heckman model (<TT>generate_synthetic_data_heckman.py</TT>), 2) Bernoulli-sigmoid model with uniform unobservables (<TT>generate_synthetic_data_bin_Y.py</TT>), and 3) Bernoulli-sigmoid model with normal unobservables (<TT>generate_synthetic_data_bin_Y.py</TT>). In all cases we provide cdoe to generate multiple synthetic datasets for which parameters are drawn from a normal distribution with user specified means and standard deviations. 
3. <strong>Fitting model.</strong> We provide code to fit three different models in stan: 1) Heckman model (<TT>fit_model_heckman.py</TT>), 2) Bernoulli-sigmoid model with uniform unobservables (<TT>fit_model_bin_Y.py</TT>), and 3) Bernoulli-sigmoid model with normal unobservables (<TT>fit_model_bin_Y.py</TT>). The Heckman model estimates parameters $(\beta_Y, \beta_T, \rho, \sigma^2)$, the Bernoulli-sigmoid model with uniform unobservables estimates parameters $(\beta_Y, \beta_\Delta, \sigma^2)$ and uses a fixed $\alpha=1$, the Bernoulli-sigmoid model with normal unobservables can either estimate parameters $(\beta_Y, \beta_\Delta, \sigma^2)$ with a fixed $\alpha$ or estimate parameters $(\beta_Y, \beta_\Delta, \alpha)$ with a fixed $\sigma^2$.
4. <strong>Analyzing model fit.</strong> Once models have been fit, figures and results in the paper can be reproduced by running <TT>make_figures.ipynb</TT>. We provide our model fits in <TT>fitted_models</TT>.
